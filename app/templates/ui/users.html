{% extends "ui/base.html" %}
{% block title %}유저 관리{% endblock %}

{% block content %}
<h2>유저 관리</h2>

<div style="display:flex;gap:8px;margin:12px 0;">
  <!-- 전체 삭제 -->
  <form method="post" action="/ui/users/delete-all"
        onsubmit="return confirm('⚠️ 모든 유저와 관련 리뷰를 완전히 삭제하시겠습니까?');">
    <button type="submit" style="background:#c33;color:white;">유저 전체 삭제</button>
  </form>
</div>

<!-- 선택 삭제 -->
<form method="post" action="/ui/users/delete-selected"
      onsubmit="return confirm('선택한 유저 및 리뷰를 삭제하시겠습니까?');">

  <table>
    <thead>
      <tr>
        <th><input type="checkbox" onclick="toggleAll(this)" /></th>
        <th>ID</th>
        <th>github_id</th>
        <th>login</th>
        <th>name</th>
        <th>created_at</th>
      </tr>
    </thead>
    <tbody>
      {% if users and users|length > 0 %}
        {% for u in users %}
        <tr>
          <td><input type="checkbox" name="user_ids" value="{{ u.id }}" /></td>
          <td>{{ u.id }}</td>
          <td>{{ u.github_id or '-' }}</td>
          <td>{{ u.login or '-' }}</td>
          <td>{{ u.name or '-' }}</td>
          <td>{{ u.created_at.strftime("%Y-%m-%d %H:%M") if u.created_at else '-' }}</td>
        </tr>
        {% endfor %}
      {% else %}
        <tr><td colspan="6" style="text-align:center;">유저가 없습니다.</td></tr>
      {% endif %}
    </tbody>
  </table>

  <div style="margin-top:8px;">
    <button type="submit" style="background:#555;color:white;">선택 유저 삭제</button>
  </div>
</form>

<script>
  function toggleAll(master) {
    const boxes = document.querySelectorAll('input[name="user_ids"]');
    boxes.forEach(b => b.checked = master.checked);
  }
</script>
{% endblock %}
